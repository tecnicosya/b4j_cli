B4J=true@Version=9.90@End=Sub Process_GlobalsEnd SubSub InitTemplateEngine    TemplateEngine.Initialize    Log("TemplateEngine initialized")End SubSub EvaluateTemplate(template As String, context As Map) As String    Try        Dim result As String = template        Dim pattern As String        Dim replacement As String        Dim iterator As Iterator        Dim key As String        iterator = context.Keys.Iterator        While iterator.HasNext            key = iterator.Next            replacement = context.Get(key)            pattern = "{{" & key & "}}"            result = result.Replace(pattern, replacement)            pattern = "{{" & ConvertToCamelCase(key) & "}}"            result = result.Replace(pattern, replacement)            pattern = "{{" & ConvertToSnakeCase(key) & "}}"            result = result.Replace(pattern, ConvertToSnakeCase(replacement))        Wend        Return result    Catch        LogError("Error evaluating template", LastException)        Return template    End TryCatch End SubSub ConvertToCamelCase(text As String) As String    Dim parts() As String    parts = text.Split("_")    Dim result As String = ""    Dim i As Int    For i = 0 To parts.Length - 1        If i = 0 Then            result = result & parts(i)        Else            result = result & parts(i).SubString(0, 1).ToUpperCase & parts(i).SubString(1)        End If    Next    Return resultEnd SubSub ConvertToSnakeCase(text As String) As String    Dim result As String = ""    Dim i As Int    For i = 0 To text.Length - 1        Dim ch As String = text.CharAt(i)        If ch = ch.ToUpperCase And ch <> ch.ToLowerCase And i > 0 Then            result = result & "_" & ch.ToLowerCase        Else            result = result & ch.ToLowerCase        End If    Next    Return resultEnd SubSub ExpandFieldsTemplate(fields As List) As String    Dim result As String = ""    Dim i As Int    For i = 0 To fields.Size - 1        Dim field As Map = fields.Get(i)        Dim fieldName As String = field.Get("name")        Dim fieldType As String = field.Get("type")        result = result & "    Dim " & fieldName & " As " & fieldType & CRLF    Next    Return resultEnd SubSub GenerateFieldProperties(fields As List) As String    Dim result As String = ""    Dim i As Int    For i = 0 To fields.Size - 1        Dim field As Map = fields.Get(i)        Dim fieldName As String = field.Get("name")        Dim fieldType As String = field.Get("type")        Dim capitalizedName As String = fieldName.SubString(0, 1).ToUpperCase & fieldName.SubString(1)        result = result & "Sub Get" & capitalizedName & " As " & fieldType & CRLF        result = result & "    Return " & fieldName & CRLF        result = result & "End Sub" & CRLF & CRLF        result = result & "Sub Set" & capitalizedName & "(value As " & fieldType & ")" & CRLF        result = result & "    " & fieldName & " = value" & CRLF        result = result & "End Sub" & CRLF & CRLF    Next    Return resultEnd SubSub TemplateEngine_Initialize    'Initialization logicEnd Sub